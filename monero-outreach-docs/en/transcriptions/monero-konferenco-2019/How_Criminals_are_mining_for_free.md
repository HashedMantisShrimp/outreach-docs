[Applause]

All right, thank you very much. For me, it's an honor and a pleasure to be here today talking about my work. So just to give a bit of background, I'm an assistant professor at King's College London —sorry, I'm not sure if we can get the slides? Good—, and I've been basically working on different aspects of cybersecurity for the last ten years but I focus a lot over the last few years on malware detection in general. And in particular, I've been actually working on, yeah, I've been over the last year, I've been working on crypto-mining malware, okay. Together with a colleague at Carlos III University of Madrid, Sergio Pastrana, we are constantly updating our numbers, so this is an ongoing work, and we are pretty excited to bring today some of our preliminary results. And basically, if you guys want to have a link of the paper you will have the white paper over here so you can get a bit more details of what we are doing.

So to give a bit of background to, nowadays malware is a real problem so there is more malware than ever before and I used to have here a slide that, so the amount of malware that was actually discovered —that was actually detected every year—, and I was also typically putting the predictions for the next year and all of a sudden I got tired of updating the same trend every year and every year. So I decided to put this plot. So basically, every new year we have much more malware than what is expected in the industry and to give you a really like brief high-level of what are the figures, this is a bit updated, but Kaspersky Labs has reported that they automatically process about 300,000 malicious files per-day. So these are binaries that have been detected, where they have been flagged as malware but they are just coming up as new binaries in into their lab. So it is obvious that malware is a huge problem, okay, and there are three main or four main factors that are contributed to this. One of them is that introduces massive revenue as we will see a bit later but one perhaps a key factor of the development of this phenomenon is that there is an increasing trend on the automatization and actually developing new malware samples in a very inexpensive way and perhaps this might be related to some code reuse oriented techniques that we have been observed also in the malicious industry which allows malware developers to create or stitch together a brand new sample of malware by putting a few propagations in [inaudible], a component or an exploit for another malware, into a brand new sample just only with a few clicks.

So it is obvious that malware nowadays is a matter of data analytics, okay, and that's basically what we've been doing over the last couple of years in my lab. And to understand a bit better how this phenomenon work and to, kind of, reinforce this notion that I mention about the software development techniques, basically, malware developers tend to gather in the underground markets and this is precisely where all these services and all these kind of places in which criminals come purchase specialized elements of the malware economy. They all gathered there and I like to see the underground markets as a form of pure capitalism, where different malware developers try new techniques, they test, and they see how it goes, and if they prove profitable, they are basically adopted by others. And there is an increasing trend on the commoditization of these services.

And I brought with me here a snapshot of how the underground economy works. So basically this is a taxonomy of the different actors and there are two main elements to understand, one of them is the, what they call the profit centers, which basically are a number of products or a number of elements that allow big teams to introduce new capital into the underground economy, okay. All hanging on top of this there is something that we call the support centers which is a number of services that actually enable these elements. All these support centers are actually [inaudible] they are interconnected so some of these elements that you can see on top of the chart, for example, spam boards or click bots, they sometimes rely on malware distribution services or traffic and acquisition services, some raw material like hosting and networking. An example might be, for example, something that they call pay-per-install services, in which you basically can go to one of these places and rent 1,000 machines and install your server on top of those machines for a few dollars. This is precisely why this is relevant to us today because there has been an increasing trend in the underground economy of using, what is called illicit crypto mining, which basically is nothing more than using illicit stolen resources to mine cryptocurrencies and typically these are distributed through botnets, as we were discussing at the end of last talk in one of the questions that someone rises.

As of also to state a bit the obvious whether this is worth it or not the question also has been solved in the previous talks by Kristy, also Howard. When we were talking about how ASIC-resistant cryptocurrencies enable end-users with vanilla PCs or not with a lot of power computation to be able actually to contribute towards the protocol, okay.

So perhaps not as stating so much the obvious, we have also seen at least where the last few years, the industry have observed that crypto-mining malware, illicit crypto mining, has been funding the different profit centers and this is important because as we were discussing over [inaudible] crypto mining seem to be actually the least problematic of all the possible uses that a bot might be doing, but this is not always true because all these profit centers actually foster more crime and enable other more sophisticated attacks like, for example, financial malware and so on and so forth. So in order, just with this whole thing in mind, I brought with me today a number of research questions that I wanted to walk you through in the next few set of slides.

So basically, we are interested on getting to know what are the preferred cryptocurrencies mined by criminals? What is the role of the underground economy and what are the different tools and techniques adopted? How many actors are they involve and how can we better understand where the financial profits that they are gaining? And what is the sophistication of the tools that they are re-doing and what are the countermeasures that we can implement.

So basically we started doing a measurement of a number of underground markets and in particular, we analyzed automatically like about 48 million posts from some of those underground markets, and we found really interesting things. This is, for example, the image that we have here, a flyer that you can find in the underground economy, and you can see how criminals are investing time on making something catchy because basically they just, by creating this flyer they are attracting new customers, and basically, you can see here someone advertising, okay, "Start your own botnet right now, you will be getting a silent miner that would allow you to make here a number of features", as you can observe on the slide. So digging a bit further analyzing these 48 million posts we found that criminals are actually purchasing inexpensive and sophisticated mining tools. So, for example, out of all the services that they've been offering we observed that there were like the average cost of an encrypted Monero was 35 US dollars so someone that actually doesn't know anything about these can get one of these binaries and start mining basically, yeah on the fly.

We also observed that people in the underground economy was even offering miners for free, they were just only getting a cut off of the profits and they were also offering vouch copies. They also offer customized services like, for example, adding new stealthy techniques like idle mining or just some elements that would enable the miner to stop mining when there is a user present on the machine, right, in order to evade detection. And there is also an increase in support so they give you an offer, they give you one of these binaries and they explicitly say, "Okay, I can guarantee you that this binary is not detected by this number of antivirus systems". Okay, and if you get caught actually you get updated, you get updates and you get a brand new software that after adding, whatever new feature like, for example, this anti emulation thing that they mention in one of this posts, later they basically explicitly say that this is fully undetected binary, okay.

So now we see how easy for these criminals is to get to mine, okay, nothing new because actually is not very difficult to get a miner from Github and start doing it yourself but what happens when you want to actually rent the botnet or when you want to actually to buy?

I was mentioning before about pay-per-install and these are some of the figures, how much does it cost for you to rent or to install 1,000 of your binaries in the underground economy, between $1,000 and $10 depending on the type of machine that you want to rent, okay. So digging a bit further into this economy we were interested on getting to know, what are people in the underground economy talking in terms of cryptocurrencies? And in particular, we were looking at different cryptocurrencies by measuring the number of posts in which some currencies is being mentioned and the number of new posts in which this is mentioned. And we can see clearly that Monero has been on the rise in the underground markets at least in terms of number of posts in which people is talking about this cryptocurrency.

So a bit motivated by this I'm gonna show you what we actually went about and trying to understand a bit better this economy. So basically we created a system that allows us to automatically analyze different malware, so basically we started by getting a bit of malware and trying to make sure that these executables are actually malware and they are actually miners, and after that, we apply something that is called a static and dynamic analysis to extract basically a number of things from these elements. And we analyzed automatically the binaries, as I said using program analysis, another type of technique, to basically get things like the wallets, for example, or the pools in which these miners are connecting to. And also we are interested in other types of metadata and we have two different tasks over here that we call campaign analysis which basically allows us to associate each of these samples to the wallet addresses, to the pools in which they are connecting to, the IP addresses, and something that we call drop files which is very relevant in the paper install scheme which is one of the key services used by some of these criminals, also DNS queries which are very relevant. We also do something that is called profit analysis, that I'll explain in the next slide a bit better what is it about and something that is called aggregation that I also brought a slide with me. Overall we analyzed like about 4 million malware samples in about of [inaudible] 1.1 were actually miners or binary files used for mining.

So this is all the number of wallets that we found in malware, okay. We can clearly see that Monero is actually the largest number of wallets that we saw a malware was actually from Monero. So what we did actually is, we went about looking at all the different transparent pools that were actually connecting from these malware samples and try to get for each of these wallets addresses the number of, the payments, the rewards that these pools actually were given to these miners. Interesting enough some of these pools are so transparent that they also give you the timestamp in which these payments have been given which allows us to actually also understand the timeline of these scammers.

As I mentioned before, common cryptocurrencies like Monero that obfuscate transactions make very difficult to understand how many actors are behind this element. You might not know how many wallets or how many samples but is difficult to understand a bit better the actors. So what we did is, we created a number of heuristics that would allow us to understand, not only samples alone but also campaigns on how all these samples actually work together. I'm not going to spend a lot of time explaining them but perhaps the most simple one for you to understand is that what happens when three or ten different binaries use the same wallet. So if they use the same wallet most likely is the same actor, right. So we connected that we created a graph and we started mining the graph to try to understand a bit better this ecosystem, okay.

Okay, so I'm going to jump to the results of what we got after doing this measurement. Okay, so overall we discover like 2000 campaigns and when looking at the different common and the different domains that this malware were sampled were connecting to, we understand we realize a number of things that was mentioning. First of all, that these miners were actually using some easy or not very sophisticated evasion techniques like, for example, using DNS domain aliases in order to not connect directly to the pools in order to avoid a bit of network detection. And when looking at different DNS requests and how disassociated to the different command and control botnets, known botnets, we realize that there are three main botnets that have been very active in this domain. One is the evil miner botnet which is on the top of these botnets that use different wallets in order to mine Monero and this is the figures that we were getting like this. The bots from these botnets have been making a about sixteen thousand Moneros altogether so far. There are a number of other known botnets but also we observed that not all the domains were actually related to known botnets, okay. So we went about analyzing all the campaigns individually and we found a new infrastructure, things that the community was was not aware of. And we, in particular, I brought with me this case study of something that we call we called to name the free booth campaign basically because they were using a domain name called free booth, and altogether this campaign actually made a huge amount of money. Worth noting that when looking at the different payments made by each of the wallets in this campaign, we observed a few things that using the same wallet but also using different wallets from the same campaign, we observed that these miners were using at the same time different pools. Meaning that they were competing with themselves which is might be seem contrary intuitive but later we understood immediately that this is a countermeasure, is a way that they use in order to be more resilient to takedown strategies, okay.

Actually here in the timeline, we can see, in the picture, in the first line, we can see when the proof of works have changed and the bigger in the blue line we can see when we've reported these wallets to some of these pools, okay. And we clearly see that both proof of works, but also when we reported these wallets, that there's this type of cyber threat. Basically, interestingly enough we saw that when we reported for example this illicit activity to mineXMR, for example, we realized that miners immediately started moving to other pools that they were less cooperative in this regard. But it's important to note as well because we discussed this before that the proof of works are very problematic for this type of criminals basically because when they need to update their malware samples they need to pay again and for them that actually makes a kind of, has an impact on their infrastructure, okay.

Okay, so this is basically the top ten campaigns and more or less the timeline in which they operated and the amount of Monero that they've been mining, which gives us a rough idea of how much this ecosystem is actually making. Actually, if you account for the total amount of Monero that they have extracted this more or less accounts for 4.5% of the entire Monero circulation which is quite a huge chunk of it.

Okay, so by looking at the prevalence of three different elements and how they correlate with the different campaigns we also managed to make a number of interesting findings. So the first one is we were looking at the number of samples, we saw that at least 92% of the campaigns were using less than 10 samples, okay, of course, all these samples can be installed in different machines so that this is actually don't tell us much but it tells us that anti-virus vendors are not making a huge effort on detecting this malware samples because campaigns doesn't need to have like a really large amount of sample stock to be able to run this business.

We also assert that about 99% of the campaigns use only 30 wallets or less, which also gives an idea of how much effort are put in pools into one of these wallets because if they were like banning botnet-like activity they would actually be having like huge number of wallets per campaign rather than having a few. And also we observed that about 90% of the campaigns were making only a hundred Moneros out of the 7,000 that we have, 700,000 that we have observed which basically tell us that the core of this illicit business has been monopolized but a really small number of wealthy actors which is actually a problem and it goes against the centralization and decentralization discussions that we've been having over the last couple of days, okay.

Really quickly, jump into the success of the different bots and reiterating in the problematic of why different, why the same campaign is actually using more than one pool to mine, putting all their bots, we're interested in getting to know two different people basically, those campaigns, the losers that we call, those ones that are making really a little amount of money and we observe that the losers were making one, were only mining mostly in one pool, okay. That doesn't mean that the champions, all of the champions actually mining in more than one pool, actually, we can observe here that about 25% of the campaigns that make a huge amount of money were mining in seven pools about 15 or 17 in five pools but a huge chunk of them like more than 40% were also using only one pool, okay.

So there are different dynamic strategies. It's clear enough that using one pool can actually mean that you are very successful but also means that if you only use one pool and you don't know very well what you are doing, chances are that you are gonna be detected and taken down easier.

Also, we were interested in looking at the success of the different campaigns from the different angles, so basically we look at different elements of the underground economy how does this map with the numbers that we observe. So in particular we were interested in getting to know how many of these actors were using paper install services, that you can buy in underground economies, mining software as well, that they were renting in these elements, also which obfuscation techniques they were using and proxies and ways in which, yeah, they can remain undetected and the period of activity. So basically we've got here that the medium actors, the ones that are doing average they use known Packers, they also use known mining software, and they started very recently in the last year, most of them, at least 60% of them.

On the other hand, the people that are actually making a huge amount of money we can see that they are using paper install services that are using more sophisticated techniques like, CNAMEs or proxy servers. They avoid using known Packers meaning that they know how to obfuscate things properly and they also have been around for four years, okay.

So just bringing to the end of the presentation a brief discussion about the countermeasures, basically control measures that they are applicable on, currently, they are not working very well. We discuss about different anomaly detection techniques, not only as part of, for example, power anomaly detection techniques but about whether changes from the proof of work or having like more RAM into this service [inaudible] to actually detect this type of threat but truth is that if you're a rootkit you might be able to actually fake these numbers and give the perspective to the user that you're using less resources than you're doing.

So, what is next? We have observed that the different criminals are just pointing and going for the long-hanging fruit. What happens if the different criminals instead of actually trying to aim for the reward for the different miners they start cheating and they start targeting 51% type of attacks? There are recent academic papers that have shown that 51% type of attacks are not worth it because you need to spend more electricity and more money trying to achieve the attack than the reward that you are getting but what if you're not paying for the electricity you are botnet and you're just using someone else's electricity, okay.

So this brings me to the conclusions, very quickly, we have observed that Monero is the preferred cryptocurrency in the underground economy. The underground economy plays an important role and that the actors are like making huge profits and also there is a small core business model run by very sophisticated actors in this behalf.

So sorry for rushing on the last few slides, I was just getting a hand on the time, so thanks a lot, and I'll be happy to take any questions.

[Applause]

I was just curious if you've made any attempt at attribution for who's kind of conducting these things? That's kind of a meme that there's like North Korean government, you know, crypto mining, via malware, or if it's like one dude in Eastern Europe somewhere, so?

So we are working on that but I should say that after spending a few months working on better ways to attribute things, I should say that that's a very challenging topic mainly because over the last few years we have learned that several sophisticated actors are very well are mimicking other actors. So the fact that you might see some features that might conclude that this kind of binary might have been compiled here or there might have some, I don't know, fingerprints from North Korea, they could well be a fake and could actually be some other random actor but it's an interesting research question and the community is very interested on that.

Yeah.

My question is, forget the mic, thank you, my questions, do you have a breakdown of the operating systems that the malware was actually running on? And what are we dealing with between say Windows, Android, GNU/Linux, Mac, iOS?

We did some small analysis, I don't remember on top of my head, but we didn't report at them because basically, we were looking at the number of binaries that we were having, how they were compiled. Most of them were targeting Windows and Linux systems, not a lot were armed or meant for Android devices but truth is that is really difficult as well to jump to conclusions because we have 1.1 million binaries but we don't know how many installations each of these binaries have so it is really tricky. Okay, thank you very much then.

[Applause]
